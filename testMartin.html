<!doctype html>

<html lang="en">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, user-scaleable=no, minimum-scale=1.0, maximum-scale=1.0" />
	<title>OrbitControls</title>
</head>

<body>

<!-- Include sources here -->
<script src="js/three.js"></script>
<script src="js/controls/OrbitControls.js"></script>
<script src="js/loaders/OBJLoader.js"></script>
<script src="objectLoad.js"></script>
<script src="EEkEy.js"></script>

<script> // ************** JavaScript **************

	// Scene variables
	var aspect, camera, scene, renderer, controls;
	var  relativeCamPos = 1;


	init();

	loadWorld();
	animate();

	function init() {

		// Add scroll listener
		document.addEventListener( 'wheel', onMouseWheel);

		// Initiate camera
		aspect = window.innerWidth / window.innerHeight;
		camera = new THREE.PerspectiveCamera(75, aspect, 1, 1000);
		camera.position.z = 50;

		// Create scene
		scene = new THREE.Scene();

		// Create renderer
		renderer = new THREE.WebGLRenderer({ antialias: true });
		renderer.setSize(window.innerWidth, window.innerHeight);
		document.body.appendChild(renderer.domElement);

		// Implement OrbitControls
		controls = new THREE.OrbitControls(camera, renderer.domElement);
		controls.addEventListener('change', render);
		controls.enableZoom = false;
		controls.enablePan = false;

	}

	/* Define the object variables that will be added to the scene here. If defined within
	the function, the other functions will not be able to reach them.
	Materials, textures etc. can still be defined within the function. */
	var sky, plane;



	/* Load objects and meshes into the scene here
	NOTE: Chrome is shit and won't let you use textures unless you use a virtual server.*/
	function loadWorld() {

		// Create a clear blue sky dome
		var skyGeometry = new THREE.SphereGeometry(500, 50, 50);

		/* ******** SKY ********
		Leave this commented out if using Google Chrome */
		var skyTexture = new THREE.TextureLoader().load( "textures/sky.jpg" );
		var skyMaterial =  new THREE.MeshBasicMaterial( {map: skyTexture} );
		/*   ********************** */

		//var skyMaterial = new THREE.MeshBasicMaterial({color: 0xd3d3d3});

		sky = new THREE.Mesh(skyGeometry, skyMaterial);
		sky.material.side = THREE.BackSide;
		scene.add(sky);

		// Load the Balloon object
		var objLoad = ["balloon/Air_Balloon.obj"];
		var posObj = [ new THREE.Vector3(0,0,0)];
		objectLoad(objLoad, posObj);



		// Create a grassy ground plane
		var planeGeometry =  new THREE.PlaneGeometry(500, 500, 100, 100);

		/* ******** GRASS ********
		Leave this commented out if using Google Chrome */

		var grassLoader = new THREE.TextureLoader();
		var grassTexture = grassLoader.load( "textures/grass.jpg");

		/* NOTE: When repeating textures it is of the utmost importance to set
		the texture's wrapS and wrapT properties to the number of repetitions. */
		grassTexture.repeat.set(50, 50);
		grassTexture.wrapS = grassTexture.wrapT = 50;
		var planeMaterial = new THREE.MeshBasicMaterial({map: grassTexture} );

		 /*  *********************** */

		//var planeMaterial = new THREE.MeshNormalMaterial();
		plane = new THREE.Mesh(planeGeometry, planeMaterial);

		/* Fix the plane's orientation, do not forget to set it to double sided
		if you wish to see it from both directions. */
		plane.rotation.x = Math.PI / 2;
		plane.position.y = -2.5;
		plane.material.side = THREE.DoubleSide;
		scene.add(plane);
		console.log(scene);
	}
	// Put all animations in here instead of in render().
	function animate() {

		requestAnimationFrame(animate);

		// ************** ANIMATIONS **************
		obj.rotation.y += 0.01;
		obj.position.y += 0.01;
		camera.position.y = obj.position.y + relativeCamPos;

		controls.target.set(obj.position.x, obj.position.y, obj.position.z);
		controls.update()

		// ************** ANIMATIONS **************
		render();

	}

	// KEEP THIS CLEAN.
	function render() {
		renderer.render(scene, camera);
	}

</script>
</body>
</html>








